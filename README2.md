## 기능 요구사항

쿠폰
- [x] 쿠폰의 이름은 반드시 존재하며 길이는 최대 30자 이하다.
- [x] 할인 금액은 1,000원 이상 10,000원 이하이며 500원 단위로 설정할 수 있다.
- [x] 할인율
    - [x] `(할인금액 * 100) / 최소 주문 금액` 식을 사용하여 계산하며, 소수점은 버린다.
    - [x] 할인율은 3% 이상 20% 이하여야 한다.
- [x] 최소 주문 금액은 5,000원 이상 100,000원 이하다.
- [x] 카테고리는 패션, 가전, 가구, 식품 네 종류이며 이 중 하나의 카테고리만 선택할 수 있다.
- [x] 발급 기간
    - [x] 시작일은 종료일보다 같거나 작다.
    - [x] 시작일과 종료일이 같다면 해당 일에만 발급할 수 있는 쿠폰이 된다.

회원 쿠폰
- [x] 회원 쿠폰은 다음 정보를 포함한다.
  - 회원 쿠폰 PK, 쿠폰 PK, 회원 PK, 사용 여부, 발급 일시, 만료 일시
- [x] 회원에게 발급된 쿠폰은 발급일 포함 7일 동안 사용 가능하다. 만료 일의 23:59:59.999999 까지 사용할 수 있다.
  - 만료 일 날짜 까지는 사용 가능한 것으로 판단한다.

쿠폰 서비스
- [x] 쿠폰을 생성할 수 있다.
- [x] 쿠폰 PK를 기준으로 쿠폰을 읽어올 수 있다.

회원 쿠폰 서비스
- [x] 회원에게 쿠폰을 발급하는 기능 구현
  - 한 명의 회원은 동일한 쿠폰을 사용한 쿠폰을 포함하여 최대 5장까지 발급할 수 있다.
- [ ] 회원의 쿠폰 목록 조회 기능 구현
  - 쿠폰과 회원에게 발급된 쿠폰의 저장소가 분리될 예정이므로, 두 테이블을 조인할 수 없다.
  - 회원의 쿠폰 목록 조회 시 쿠폰, 회원에게 발급된 쿠폰의 정보를 모두 보여줄 수 있어야 한다.
  - [ ] 복제 지연 문제를 해결하기 위해 reader db에 없으면 writer db까지 조회하는 로직 구현
- [ ] 성능을 위해 쿠폰을 캐싱하고, 회원의 쿠폰 목록 조회 시 쿠폰 정보는 캐시를 통해 조회하도록 수정한다.

복제 지연으로 인한 이슈 해결
- [x] 디폴트 캐시를 사용하여 복제 지연을 해결한다.
  - [x] 쿠폰을 저장할 때 캐시에도 저장한다.
  - [x] 쿠폰을 조회할 때 캐시에서 먼저 시도한다.
- [ ] Redis를 사용해 복제 지연을 해결한다.
  - [ ] Coupon을 생성하여 db에 저장할 때, 같은 트랜잭션에서 Redis에도 저장한다.
  - [ ] Coupon을 조회할 때 Redis에서 먼저 조회를 시도한다.
